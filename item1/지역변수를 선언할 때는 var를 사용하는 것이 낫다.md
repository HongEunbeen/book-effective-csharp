## ✔ 지역변수를 선언할 때 var을 사용하는 이유

**C#언어의 암시적 타입 선언 제공**

C#언어는 익명 타입을 지원하기 위해 타입을 암시적으로 선언할 수 있는 손쉬운 방법을 제공합니다.

**쿼리 구문의 더 다양한 기능 사용**

`IQueryable<T>`를 반환하는 일부 쿼리 구문을 `IEnumarable<T>`로 사용할 경우 `IQueryable<T>`의 다양한 기능을 사용할 수 없습니다. 즉 정확한 반환 타입을 알지 못한채 명시적으로 올바르지 않은 타입을 지정하면 득보다는 실을 얻게 됩니다.

**코드의 가독성**

`Dictonary<int, Queue<string>>` 타입으로 변수를 선언하는 것 보다는 `JobsQueuedByRegion` 으로 변수명을 선언하는 것이 더 타입 유추가 가능합니다.

개발자 입장에서는 변수의 타입보다는 변수의 의미 파악에 더 집중하게 됩니다.

컴파일러 입장에서는 개발자가 특정 객체의 타입을 명시적으로 지정하지 않더라도 객체 생성에 문제가 있을 경우 오류 보고가 가능합니다.

## 🤔 타입을 명시적으로 지정할 경우 타입의 안정성이 향상된다?

타입을 명시적으로 지정할 경우 타입의 안정성이 향상될것이라 생각하지만 아닙니다!

오히려, 개발자가 올바르게 타입을 지정하지 않을경우 타입 안정성을 해칠 수 있습니다.

지역변수에 대한 타입 추론은 동적 타이핑이 수행되는 것이 아닌 할당 연산자 오른쪽의 타입을 확인해 변수의 타입을 결정하는 것입니다. 랜덤이나 마구잡이로 정해지는 것이 아닌 컴파일러에게 변수의 타입을 명시적으로 알려주지 않아도 개발자를 대신해 올바른 타입을 추론해 주는 것입니다.

이처럼, `var`를 사용해 컴파일러에게 적절한 타입을 선택하도록 위임하는 편이 좋은 결과를 가져올 수 있습니다.

## 🚫 var의 단점

**var의 과도한 사용**

`var`를 과도하게 사용한다면 코드의 가독성을 해치고, 내부적으로 이루어지는 자동 타입 변환 과정으로 인해 발견하기 어려운 버그를 만들 수 있습니다.

**코드의 가독성의 문제**

```csharp
var foo = new MyType();
var result = someObject.DoSomeWork(anotherParamter);
//var HighestSellingProject = someObject.DoSomeWork(anotherParamter); //이렇게 해주어야 함
```

위의 코드처럼 지역변수를 초기화 할때 `var`를 사용하지만 C# 컴파일러는 런타임에 객체가 어떤 타입이 될 지 추론할 수 없습니다. 

즉, 단순히 컴파일 타입과 메서드의 원형을 기반으로 변수를 추론하게 되는데 개발자는 대부분 런타임의 타입으로 가정하기에 상속 관계에서의 오버라이딩 문제에 대한 코드의 가독성에 문제가 발생합니다.

**개발자의 추론 타입과 컴파일러의 추론 타입이 다른 경우**

개발자가 `var`를 사용해 컴파일러에게 타입 추론을 위임한 경우, 컴파일러는 할당문 오른쪽의 내용을 기반으로 타입을 결정합니다.

```csharp
var total = 100 * GetMagicNumber() / 6;
Console.WirteLine($"Value : {total}");

double total = 100 * GetMagicNumber() / 6;
Console.WirteLine($"Value : {total}");
```

이때, `숫자타입`을 사용하게 되는 경우를 주의해야 합니다. C#이 제공하는 내장 `숫자타입`들은 다양한 형변화 기능을 가지고 있고 정밀도도 다르기에 `숫자타입`과 `var`를 함께 사용하면 문제가 발생할 수 있습니다.

또한, 암시적 변환이 가능한 경우 컴파일러는 메시지를 주지 않기때문에 더욱 더 주의해야 합니다.

**코드의 유지보수 문제**

컴파일러는 일관된 방식으로 타입추론 하지만 개발자는 그렇지 않기때문에 변수명을 더욱더 명시적으로 작성해야 합니다.

**늦은 바인딩 메커니즘의 미적용**

`확장 메서드`와 같이 `virtual`로 선언될 수 없는 메서드에 대해 컴파일러는 객체의 런타임 타입이 아닌 컴파일 타임 타입에 준하여 메서드를 수행하므로 런타임 타입에 호출 할 수 있는 인스턴스가 있다는 사실을 인지하지 못해 추론이 불가한 경우가 있습니다.

## 🎉 결론

코드를 읽을 때 지역변수의 타입을 명확히 유추할 수 없고 모호함을 불러일으킬 가능성 있다면 차라리 타입을 명시적으로 사용하는 편이 좋습니다.

하지만, 대부분의 경우 변수의 이름을 통해 역할을 명확하게 드러내도록 코드 작성하는 것이 더 좋습니다.

쿼리식에서 변수를 초기화하는 경우 변수의 타입이 명확하게 드러나는 경우에 `var`를 사용하면 더 많고 효율적인 메서드를 사용할 수 있습니다.

## 📌 요점

- 코드를 읽을 때 타입을 명시적으로 드러내야 하는 경우가 아니라면 `var`를 사용하는 것이 좋습니다.
- 내장 `숫자타입`을 선언할 때는 명시적으로 타입을 선언하는 편이 좋습니다.
- 명시적으로 타입을 사용해도 타입 안정성이 향상되거나 가독성을 개선하지는 못합니다.
- 올바르지 않게 타입을 명시하게 되면 컴파일러의 도움을 얻어 충분히 피해갈 수 있는 문제를 강제로 일으킬 수 있습니다.
